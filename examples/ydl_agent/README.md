# 问题收集与存储系统

这是一个基于 SwarmGo 框架的双 Agent 系统，用于收集用户问题回答并将结果存储到本地文件。

## 功能特性

- **问题收集 Agent**：负责逐一询问预设问题并收集用户回答
- **结果存储 Agent**：负责将收集的数据保存到本地文件
- **智能转移**：当所有问题回答完毕后，自动转交给存储 Agent
- **友好交互**：提供良好的用户体验和清晰的指引

## 系统架构

```
用户输入 → 问题收集Agent → 收集完成 → 转移到存储Agent → 保存到文件
```

### Agent 设计

1. **QuestionCollectorAgent（问题收集助手）**
   - 预设 5 个问题（姓名、年龄、职业、喜欢的颜色、兴趣爱好）
   - 逐一询问并等待用户回答
   - 收集完成后调用转移函数

2. **ResultStorageAgent（结果存储助手）**
   - 接收转移过来的问题和答案数据
   - 格式化数据并保存到带时间戳的文件
   - 提供保存成功的确认信息

## 安装和配置

### 1. 环境要求

- Go 1.19 或更高版本
- OpenAI API 密钥

### 2. 配置 API 密钥

#### 方法一：使用 .env 文件（推荐）

```bash
# 复制示例配置文件
cp ../../.env.example ../../.env

# 编辑 .env 文件，填入您的 OpenAI API 密钥
# OPENAI_API_KEY=your_actual_api_key_here
```

#### 方法二：设置环境变量

```bash
export OPENAI_API_KEY=your_actual_api_key_here
```

### 3. 获取 OpenAI API 密钥

访问 [OpenAI API Keys](https://platform.openai.com/api-keys) 创建您的 API 密钥。

## 运行程序

```bash
# 进入项目目录
cd /path/to/swarmgo/examples/ydl_agent

# 运行程序
go run main.go
```

## 使用流程

1. **启动程序**：运行 `go run main.go`
2. **开始对话**：程序会自动开始第一个问题
3. **回答问题**：按照提示逐一回答 5 个问题
4. **自动保存**：回答完成后，系统会自动转移到存储 Agent 并保存结果
5. **查看结果**：在当前目录下查看生成的结果文件

## 输出文件格式

程序会生成类似 `user_survey_results_2024-01-15_14-30-25.txt` 的文件，内容格式如下：

```
=== 用户调研结果 ===
收集时间: 2024-01-15 14:30:25

问题 1: 请问您的姓名是什么？
答案 1: 张三

问题 2: 您的年龄是多少？
答案 2: 25岁

...
```

## 交互命令

- 输入 `quit` 或 `exit` 退出程序
- 正常回答问题即可继续流程

## 技术实现

### 核心组件

- **Agent 系统**：基于 SwarmGo 框架的智能代理
- **转移机制**：使用 TransferFunction 实现 Agent 间的无缝切换
- **自定义函数**：SaveResultsFunction 处理文件保存逻辑
- **状态管理**：通过结构体字段管理问题进度和答案收集

### 关键特性

- **类型安全**：完整的 Go 类型系统支持
- **错误处理**：友好的错误提示和异常处理
- **文件管理**：自动生成带时间戳的唯一文件名
- **扩展性**：易于添加新问题或修改存储格式

## 自定义配置

### 修改问题列表

在 `NewQuestionCollectorAgent` 函数中修改 `questions` 数组：

```go
questions: []string{
    "您的自定义问题1？",
    "您的自定义问题2？",
    // 添加更多问题...
},
```

### 修改存储格式

在 `SaveResultsFunction.work` 方法中自定义文件内容格式。

## 故障排除

### 常见问题

1. **API 密钥错误**
   - 确保 API 密钥正确且有效
   - 检查 API 密钥是否有足够的配额

2. **网络连接问题**
   - 确保网络连接正常
   - 检查防火墙设置

3. **文件权限问题**
   - 确保程序有写入当前目录的权限

### 调试模式

程序会输出详细的运行日志，帮助诊断问题。

## 扩展建议

- 添加数据验证功能
- 支持多种文件格式（JSON、CSV 等）
- 实现问题的动态配置
- 添加数据加密存储
- 支持云端存储集成

## 许可证

本项目遵循 SwarmGo 框架的许可证条款。